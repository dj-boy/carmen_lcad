include ../Makefile.conf

# Module name and description
MODULE_NAME = GRID_MAPPING_PACKAGE
MODULE_COMMENT = Grid Mapping Package

LINK = g++

# Application specific include directories.
IFLAGS += -I$(CARMEN_HOME)/sharedlib/prob_models
LFLAGS += -L$(CARMEN_HOME)/sharedlib/prob_models

IFLAGS += -I$(CARMEN_HOME)/sharedlib/libtf/src -I/usr/local/include/bullet
LFLAGS += -L$(CARMEN_HOME)/sharedlib/libtf/src

# Required default libraries to comunicate with Carmen Core.
LFLAGS += -lprob_models -lmap_io -lglobal -lparam_interface -llaser_interface -lipc \
	-lgrid_mapping_interface  -lobstacle_avoider_interface -llocalize_ackerman_interface \
	-lultrasonic_filter_interface -lvisual_odometry_interface -ljpeg \
	-llocalize_ackerman_interface -lmap_interface  -lmap_server_interface \
	-ltf -lBulletCollision -lBulletDynamics -lBulletSoftBody -lLinearMath -lboost_thread -lrt -lboost_signals -lboost_system -lrotation_geometry
	
CFLAGS +=  -std=c99

# Source code files (.c, .cpp) 
SOURCES = grid_mapping_main.cpp message_interpolation.cpp grid_mapping_interface.c  grid_mapping.c grid_mapping_test.c build_complete_map.c complete_map_to_block_map.c

# Public headers, linked to 'carmen/include/carmen/'.
PUBLIC_INCLUDES = grid_mapping_messages.h grid_mapping_interface.h grid_mapping.h

# Public libraries, linked to 'carmen/lib'.
PUBLIC_LIBRARIES = libgrid_mapping_interface.a libgrid_mapping.a

# Public binaries, your application specific module laucher, copied to 'carmen/bin'.
PUBLIC_BINARIES = grid_mapping build_complete_map complete_map_to_block_map

TARGETS = libprob_models.a libgrid_mapping_interface.a libgrid_mapping.a grid_mapping  grid_mapping_test build_complete_map complete_map_to_block_map
PUBLIC_LIBRARIES_SO =

ifndef NO_PYTHON
TARGETS += 
endif

# If you set graphics support in configure.
ifndef NO_GRAPHICS
IFLAGS += `$(GTK_CONFIG) --cflags` 
LFLAGS += `pkg-config --libs gtk+-2.0`

#Carmen Global Graphic Library and Gtk+2 Graphics Libraries
LFLAGS += -lglobal_graphics -lgrid_mapping_interface -lglib-2.0

#Source code file (.c)
SOURCES += grid_mapping_view.c
PUBLIC_BINARIES += grid_mapping_view
TARGETS += grid_mapping_view
endif

libgrid_mapping_interface.a:	grid_mapping_interface.o

libgrid_mapping.a: grid_mapping.o

libgrid_mapping_interface.so.1:	libgrid_mapping_interface.o

grid_mapping: grid_mapping_main.o libgrid_mapping.a

grid_mapping_view: grid_mapping_view.o libgrid_mapping_interface.a

grid_mapping_test:  grid_mapping_test.o libgrid_mapping.a libgrid_mapping_interface.a

build_complete_map: build_complete_map.o libgrid_mapping.a

complete_map_to_block_map: complete_map_to_block_map.o libgrid_mapping.a

# rules

libprob_models.a: 
	$(MAKE) -C $(CARMEN_HOME)/sharedlib/prob_models/

clean: clean_prob_models

clean_prob_models:
	$(MAKE) clean -C $(CARMEN_HOME)/sharedlib/prob_models/
	
include ../Makefile.rules
